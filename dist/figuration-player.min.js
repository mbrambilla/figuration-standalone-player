!function(t){"use strict";String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var e="MutationObserver"in window&&window.MutationObserver,i=function(e,i){if(MutationObserver){var a=t(e[0].target);a.is(i)||a.parents("[data-cfw-mutate]").first().triggerHandler("mutate.cfw.mutate")}};t.fn.CFW_mutateTrigger=function(){return this.find("[data-cfw-mutate]").each((function(){t(this).triggerHandler("mutate.cfw.mutate")})),this},t.fn.CFW_mutationIgnore=function(){return e?(this.each((function(){var e=t(this).data("cfw-mutationobserver");void 0!==e&&e.disconnect(),t(this).removeData("cfw-mutationobserver").off("mutated.cfw.mutate")})),this):this},t.fn.CFW_mutationListen=function(){return e?(this.CFW_mutationIgnore(),this.each((function(){var e=this,a=new MutationObserver((function(t){i(t,e)}));a.observe(this,{attributes:!0,childList:!0,characterData:!1,subtree:!0,attributeFilter:["style","class"]}),t(this).data("cfw-mutationobserver",a).on("mutated.cfw.mutate",i)})),this):this},t.fn.CFW_getID=function(e){var i=t(this),a=i.attr("id");if(void 0===a){do{a=e+"-"+~~(1e6*Math.random())}while(document.getElementById(a));i.attr("id",a)}return a},t.fn.CFW_trigger=function(e,i){var a=t.Event(e);return t.isPlainObject(i)&&(a=t.extend({},a,i)),t(this).trigger(a),!a.isDefaultPrevented()},t.fn.CFW_parseData=function(e,i){var a={},s=t(this).data();for(var r in e=e.capitalize(),i)if(Object.prototype.hasOwnProperty.call(i,r)){var n=r.capitalize();void 0!==s["cfw"+e+n]&&(a[r]=s["cfw"+e+n])}return a},t.CFW_controlEnable=function(e){t(e).removeClass("disabled").removeAttr("tabindex").removeAttr("disabled").closest("label").removeClass("disabled")},t.CFW_controlDisable=function(e){var i=t(e);i.length&&/button|fieldset|input|optgroup|option|select|textarea/i.test(i[0].tagName)?(i.prop("disabled",!0),i.closest("label").addClass("disabled")):i.addClass("disabled").attr("tabindex",-1)},t.CFW_isDisabled=function(e){if(e instanceof jQuery&&(e=e[0]),!e||e.nodeType!==Node.ELEMENT_NODE)return!0;if(/^(button|input|select|textarea)$/i.test(e.nodeName)){var i=t(e).closest("fieldset")[0];if(i&&i.disabled)return!0}return!!e.classList.contains("disabled")||("boolean"==typeof e.disabled?e.disabled:e.hasAttribute("disabled"))}}(jQuery),function(t){"use strict";var e={audio:null,video:null};e.audio=function(){var t=document.createElement("audio"),e=!1;try{(e=!!t.canPlayType)&&((e=new Boolean(e)).ogg=t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),e.mp3=t.canPlayType("audio/mpeg;").replace(/^no$/,""),e.opus=t.canPlayType('audio/ogg; codecs="opus"')||t.canPlayType('audio/webm; codecs="opus"').replace(/^no$/,""),e.wav=t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),e.m4a=(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(t){}return e}(),e.video=function(){var t=document.createElement("video"),e=!1;try{(e=!!t.canPlayType)&&((e=new Boolean(e)).ogg=t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),e.h264=t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),e.webm=t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""),e.vp9=t.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,""),e.hls=t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,""))}catch(t){}return e}();var i=function(e,a){this.$element=t(e),this.type="audio",this.$media=null,this.media=null,this.$player=null,this.$focus=null,this.$sources=null,this.$sliderSeek=null,this.$volSeek=null,this.activity=null,this.over=null,this.userActive=!0,this.activityTimer=null,this.mouseActivity=null,this.played=!1,this.status={duration:0,currentTime:0,remaining:0},this.support={mute:!0,volume:!0},this.trackValid=[],this.trackCurrent=-1,this.$captionWrapper=null,this.$scriptElm=null,this.scriptCurrent=-1,this.scriptCues=null,this.seekPoint=".player-transcript-seekpoint, .player-description-seekpoint",this.descCurrent=-1,this.descCues=null,this.trackDescription=[],this.$textDescribeElm=null,this.textDescribeCurrent=-1,this.textDescribeCues=null;var s=this.$element.CFW_parseData("player",i.DEFAULTS);this.settings=t.extend({},i.DEFAULTS,s,a),this._init()};i.DEFAULTS={mediaDescribe:!1,textDescribe:-1,textDescribeAnnounce:!1,textDescribeVisible:!0,transcript:-1,transcriptScroll:!0,transcriptDescribe:!0,transcriptOption:!0},i.prototype={_init:function(){this.$media=this.$element.find("audio, video"),this.media=this.$media[0],void 0!==this.media&&("video"===this.media.nodeName.toLowerCase()&&(this.type="video"),"audio"===this.type&&!e.audio||"video"===this.type&&!e.video?this.$media.CFW_trigger("noSupport.cfw.player"):(this.$sources=this.$media.find("source"),this.$sources.length&&(this.$sources.each((function(){t(this).attr("data-src-orig",t(this).attr("src"))})),this.$element.attr("data-cfw","player").addClass("player-unstarted"),this.$player=this.$element.find('[data-cfw-player="player"]'),this.$player.length>0&&(this.media.controls=!1),this.settings.mediaDescribe&&this.description(),this.loadComplete())))},insertPlayer:function(){var e=t(document.createElement("div")).addClass("player");this.$media.after(e)},loadCheck:function(){var t=this,e=0;try{this.media.play(),this.media.pause()}catch(t){return void this.error()}var i=setInterval((function(){return t.media.readyState>0?(clearInterval(i),void t.loadComplete()):3===t.media.networkState||75===e?(clearInterval(i),void t.error()):void e++}),50)},loadComplete:function(){var e=this;this.$media.on("error",(function(){e.error()})),this.$media.on("play canplay pause",(function(){e.controlStatus(),e.playedStatus()})),this.$media.on("loadedmetadata loadeddata progress canplay canplaythrough timeupdate durationchange",(function(){e.playedStatus(),e.timeStatus(),e.seekStatus()})),this.$media.on("ended",(function(){e.seekReset()})),this.$media.on("volumechange",(function(){e.muteStatus(),e.volumeStatus()})),"video"===this.type&&(t(document).on("webkitfullscreenchange mozfullscreenchange MSFullscreenChange fullscreenchange",(function(){e.fullscreenStatus()})),this.$player.on("mouseenter mouseleave",(function(t){switch(e.activity=!0,t.type){case"mouseenter":e.over=!0;break;case"mouseleave":e.over=!1}})),this.$element.on("mousemove mousedown mouseup keydown keyup touchmove touchstart touchend",(function(t){switch(e.activity=!0,t.type){case"mousedown":case"touchstart":clearInterval(e.mouseActivity),e.mouseActivity=setInterval((function(){e.activity=!0}),250);break;case"mouseup":case"touchend":clearInterval(e.mouseActivity)}})),this.$media.on("click",(function(){e.toggle(),e._focusHelper()})),this.activityInit()),this.$player.on("click",'[data-cfw-player="play"]',(function(t){t.preventDefault(),e.media.play(),e._focusControl(e.$player.find('[data-cfw-player="pause"]')[0])})),this.$player.on("click",'[data-cfw-player="pause"]',(function(t){t.preventDefault(),e.media.pause(),e._focusControl(e.$player.find('[data-cfw-player="play"]')[0])})),this.$player.on("click",'[data-cfw-player="stop"]',(function(t){t.preventDefault(),e.stop(),e._focusControl(this)})),this.$player.on("click",'[data-cfw-player="mute"]',(function(t){t.preventDefault(),e.mute(),e._focusControl(this)})),this.$player.on("click",'[data-cfw-player="loop"]',(function(t){t.preventDefault(),e.loop(),e._focusControl(this)})),this.$player.on("click",'[data-cfw-player="fullscreen"]',(function(t){t.preventDefault(),e.fullscreen(),e._focusControl(this)})),this.$player.on("click",'[data-cfw-player="description"]',(function(t){t.preventDefault(),e.description(),e._focusControl(this)})),this.$element.on("keydown",(function(t){e._actionsKeydown(t)})),this.controlStatus(),this.volumeSupport(),this.timeStatus(),this.seekStatus(),this.muteStatus(),this.volumeStatus(),this.loopStatus();var i=this.$element.find('[data-cfw-player="caption-display"]');i.length&&(this.$captionWrapper=i,this.captionDisplayUpdate(null)),this.trackList(),this.trackInit(),this.scriptInit(),this.textDescriptionInit(),this.$player.addClass("ready");var a=document.createElement("div");a.className="player-focus sr-only",a.tabIndex="-1",this.$focus=t(a),this.$element.prepend(this.$focus),this.$media.CFW_trigger("ready.cfw.player"),this.media.autoplay&&this.media.play(),this.$element.attr("data-cfw-mutate","").CFW_mutationListen().on("mutate.cfw.mutate",(function(){t(this).is(":hidden")&&e.media.pause()}))},error:function(){this.$media.CFW_trigger("error.cfw.player")},toggle:function(){this.media.paused?(this.playedStatus(!0),this.media.play()):this.media.pause()},play:function(){this.playedStatus(!0),this.media.play()},pause:function(){this.media.pause()},stop:function(){this.media.pause(),this.seekTo(0)},controlStatus:function(){var t=this.$player.find('[data-cfw-player="control"]'),e=this.$player.find('[data-cfw-player="play"]'),i=this.$player.find('[data-cfw-player="pause"]');t.removeClass("pause play"),e.add(i).removeClass("on off").addClass("off"),this.media.paused?(t.addClass("pause"),e.removeClass("off").addClass("on"),this.$element.addClass("player-paused")):(t.addClass("play"),i.removeClass("off").addClass("on"),this.$element.removeClass("player-paused"))},playedStatus:function(t){void 0===t&&(t=!1),this.played||(t||this.media.played.length>0)&&(this.played=!0,this.$element.removeClass("player-unstarted"))},timeStatus:function(){this.status.duration=this.media.duration,this.status.currentTime=this.media.currentTime,this.status.remaining=this.status.duration-this.status.currentTime,this.status.remaining<0&&(this.status.remaining=0);var t=this.$player.find('[data-cfw-player="time-duration"]'),e=this.$player.find('[data-cfw-player="time-current"]'),i=this.$player.find('[data-cfw-player="time-remainder"]');this.status.duration>0?this.$player.removeClass("player-notime"):this.$player.addClass("player-notime"),this.status.duration===1/0?this.$player.addClass("player-live"):this.$player.removeClass("player-live"),t.html(this.timeSplit(this.status.duration)),e.html(this.timeSplit(this.status.currentTime)),i.html(this.timeSplit(this.status.remaining))},timeSplit:function(t){(isNaN(t)||t===1/0)&&(t=0);var e=Math.floor(t/3600),i=Math.floor(t/60)-60*e,a=Math.floor(t)-3600*e-60*i,s=this.timeDigits(i)+":"+this.timeDigits(a);return e>0&&(s=e+":"+s),0===s.indexOf("0")&&(s=s.substr(1)),s},timeDigits:function(t){return("0"+t).slice(-2)},seekStatus:function(){this.$player.find('[data-cfw-player="seek"]').find('input[type="range"]').length?this.seekRange():this.seekProgress()},seekRange:function(){var e=this;if(!isNaN(this.media.duration)&&this.media.duration!==1/0){var i=this.$player.find('[data-cfw-player="seek"]').find('input[type="range"]').eq(0);null===this.$sliderSeek&&(this.$sliderSeek=i,i.prop({min:0,max:this.media.duration,step:1}),i.on("change input",(function(){var t=parseFloat(i.val()),a=e.media.paused;e.media.pause(),e.seekTo(t),a||e.media.play()})),i.on("keydown",(function(e){"keydown"===e.type&&e.stopPropagation(),t(this).off("keyup.cfw.playerSeek"),t(this).one("keyup.cfw.playerSeek",(function(t){"keyup"===t.type&&t.stopPropagation()}))}))),i.val(this.media.currentTime);var a=this.timeSplit(this.media.currentTime)+" / "+this.timeSplit(this.media.duration);i.attr("aria-valuetext",a)}},seekProgress:function(){if(!isNaN(this.media.duration)&&this.media.duration!==1/0){var t=this.$player.find('[data-cfw-player="seek-current"]'),e=t.children(".progress-bar").length>0?t.children(".progress-bar").first():t,i=this.media.currentTime/this.media.duration*100;i>100&&(i=100),t.attr({role:"progressbar","aria-label":"Playback progress","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":i}),e.css("width",i+"%")}},seekReset:function(){this.media.loop?this.media.play():this.media.pause()},seekIncrement:function(t){var e=this.media.currentTime+t;e<0&&(e=0),e>this.media.duration&&(e=this.media.duration),this.seekTo(e)},seekTo:function(t){var e=this.media.seekable;e.length>0&&t>=e.start(0)&&t<=e.end(0)&&(this.media.currentTime=t)},mute:function(){this.media.muted=!this.media.muted,this.muteStatus(),this.volumeStatus()},muteStatus:function(){var e=this.$player.find('[data-cfw-player="mute"]');this.support.mute?this.media.muted?e.addClass("active"):e.removeClass("active"):t.CFW_controlDisable(e)},volumeSupport:function(){var t=this.media.muted,e=this.media.volume,i=.5;.5===this.media.volume&&(i=.25),this.media.volume=i,this.media.volume!==i&&(this.support.mute=!1,this.support.volume=!1),this.media.volume=e,this.media.muted=t},volumeStatus:function(){this.$player.find('[data-cfw-player="volume"]').find('input[type="range"]').length&&this.volumeRange()},volumeRange:function(){var e=this,i=this.$player.find('[data-cfw-player="volume"]');if(this.support.mute){var a=i.find('input[type="range"]').eq(0);if(null===this.$volSeek&&(this.$volSeek=a,a.prop({min:0,max:1,step:.05}),a.on("change input",(function(){var t=parseFloat(a.val());0===t?e.media.muted=!0:(e.media.muted=!1,e.media.volume=t)})),a.on("keydown",(function(e){"keydown"===e.type&&e.stopPropagation(),t(this).off("keyup.cfw.playerSeek"),t(this).one("keyup.cfw.playerSeek",(function(t){"keyup"===t.type&&t.stopPropagation()}))}))),this.media.muted)a.val(0),a.attr("aria-valuetext","0%");else{a.val(this.media.volume);var s=parseInt(100*this.media.volume,10);a.attr("aria-valuetext",s+"%")}}else t.CFW_controlDisable(i)},volumeIncrement:function(t){var e=100*this.media.volume+t;e<0&&(e=0),e>100&&(e=100),this.media.volume=parseInt(e,10)/100},loop:function(t){this.media.loop=void 0!==t?t:!this.media.loop,this.loopStatus()},speed:function(t){void 0!==t&&(this.media.playbackRate=t)},loopStatus:function(){var t=this.$player.find('[data-cfw-player="loop"]');this.media.loop?(t.addClass("active"),this._pressedState(t,!0)):(t.removeClass("active"),this._pressedState(t,!1))},isFullScreen:function(){return t(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement).is(this.$element)},fullscreen:function(){if("audio"!==this.type)if(this.isFullScreen())document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();else{var t=this.$element[0];t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen()}},fullscreenStatus:function(){var t=this.$player.find('[data-cfw-player="fullscreen"]');this.isFullScreen()?(t.addClass("active"),this.$element.addClass("player-fulldisplay"),this.$media.CFW_trigger("enterFullscreen.cfw.player")):(t.removeClass("active"),this.$element.removeClass("player-fulldisplay"),this.$media.CFW_trigger("exitFullscreen.cfw.player"))},_srcHasAlternate:function(t){return this.$sources[0].hasAttribute("data-src-"+t)},_srcIsAlternate:function(t){return this.$sources.first().attr("data-src-"+t)===this.$sources.first().attr("src")},_srcLoadAlternate:function(e){var i=this,a=this.media.currentTime,s=this.media.paused;this.$sources.each((function(){t(this).attr("src",t(this).attr("data-src-"+e))})),this.$media.one("loadeddata",(function(){i.seekTo(a),s||i.media.play()})),this.media.load()},description:function(){if(this._srcHasAlternate("describe")){var t=this.$player.find('[data-cfw-player="description"]');this._srcIsAlternate("describe")?(this._srcLoadAlternate("orig"),t.removeClass("active")):(this._srcLoadAlternate("describe"),t.addClass("active"))}},trackList:function(){var t=this,e=this.media.textTracks;if(!(e.length<=0)){for(var i=[],a=[],s=0;s<e.length;s++)"captions"!==e[s].kind&&"subtitles"!==e[s].kind||i.push(s),"descriptions"===e[s].kind&&a.push(s);this.trackValid=i,this.trackDescription=a,this.media.textTracks.addEventListener("change",(function(){t.trackStatus()}))}},trackInit:function(){var e=this,i=this.$player.find('[data-cfw-player="caption"]');if(!(i.length<=0))if(this.trackValid.length<=0)t.CFW_controlDisable(i);else{if(1===this.trackValid.length)this.$player.on("click",'[data-cfw-player="caption"]',(function(t){t.preventDefault(),i.hasClass("active")?e.trackSet(-1):e.trackSet(0),e._focusControl(this)})),"showing"===this.media.textTracks[0].mode&&this.trackSet(0);else{var a=t('<ul class="player-caption-menu dropdown-menu"></ul>');i.wrap('<span class="player-caption-wrapper"></span>'),i.parent().append(a);var s=a.CFW_getID("cfw-player"),r=t('<li class="player-caption-off"><button type="button" class="dropdown-item" data-cfw-player-track="-1">Off</button></li>');a.append(r);for(var n=this.media.textTracks,c=0;c<n.length;c++)"showing"===n[c].mode&&this.trackSet(c);for(var l=0;l<this.trackValid.length;l++){var o=this.trackValid[l];r=t('<li><button type="button" class="dropdown-item" data-cfw-player-track="'+o+'">'+n[o].label+"</button></li>"),a.append(r)}this.$player.on("click","[data-cfw-player-track]",(function(i){i.preventDefault();var a=t(this).attr("data-cfw-player-track");e.trackSet(a)})),i.CFW_Dropdown({target:"#"+s})}this.trackStatus()}},trackSet:function(t){t=parseInt(t,10);var e=this.media.textTracks;if(!(e.length<=0)){-1!==this.trackCurrent&&this._cuechangeDisable(this.trackCurrent,"captionDisplay"),this.trackCurrent=t;for(var i=0;i<e.length;i++)"showing"===e[i].mode&&(e[i].mode="hidden"),i===t&&(e[i].mode=null!==this.$captionWrapper?"hidden":"showing");-1!==this.trackCurrent&&null!==this.$captionWrapper&&this._cuechangeEnable(this.trackCurrent,"captionDisplay",this.captionDisplayUpdate),this.trackStatus()}},trackStatus:function(){var t=this.media.textTracks;if(!(t.length<=0)){var e=this.$player.find('[data-cfw-player="caption"]');if(!(e.length<=0))if(1===this.trackValid.length)-1===this.trackCurrent?(e.removeClass("active"),this._pressedState(e,!1)):(e.addClass("active"),this._pressedState(e,!0));else{var i=e.parent();e.removeClass("active"),i.removeClass("active"),i.find("[data-cfw-player-track]").removeClass("active").removeAttr("aria-pressed");for(var a=0;a<t.length;a++)a===this.trackCurrent&&(e.addClass("active"),i.addClass("active"),i.find('[data-cfw-player-track="'+a+'"]').addClass("active").attr("aria-pressed","true"))}}},scriptInit:function(){var e=this,i=this.$player.find('[data-cfw-player="transcript"]');if(!(i.length<=0))if(this.trackValid.length<=0)t.CFW_controlDisable(i);else{if(1!==this.trackValid.length||this.settings.transcriptOption){var a=t('<ul class="player-script-menu dropdown-menu"></ul>');i.wrap('<span class="player-script-wrapper"></span>'),i.parent().append(a);var s=a.CFW_getID("cfw-player"),r=t('<li class="player-script-off"><button type="button" class="dropdown-item" data-cfw-player-script="-1">Off</button></li>');a.append(r);for(var n=this.media.textTracks,c=0;c<this.trackValid.length;c++){var l=this.trackValid[c];r=t('<li><button type="button" class="dropdown-item" data-cfw-player-script="'+l+'">'+n[l].label+"</a></li>"),a.append(r)}if(this.settings.transcriptOption){r=t('<li class="dropdown-divider"></li>'),a.append(r);var o=this.settings.transcriptScroll?"checked":"",p="transcriptScroll-"+s;r=t('<li class="dropdown-text"><div class="form-check"><input type="checkbox" data-cfw-player-script-scroll class="form-check-input" '+o+' id="'+p+'"> <label class="form-check-label" for="'+p+'">Auto-scroll</label></div></li>'),a.append(r);var d=this.settings.transcriptDescribe?"checked":"",u="transcriptDescribe-"+s;r=t('<li class="dropdown-text"><div class="form-check"><input type="checkbox" data-cfw-player-script-describe class="form-check-input" '+d+' id="'+u+'"> <label class="form-check-label" for="'+u+'">Show Description</label></div></li>'),a.append(r)}this.$player.on("click","[data-cfw-player-script]",(function(i){i.preventDefault();var a=t(this).attr("data-cfw-player-script");e.scriptSet(a)})),this.settings.transcriptOption&&(this.$player.on("click","[data-cfw-player-script-scroll]",(function(){e.settings.transcriptScroll=!e.settings.transcriptScroll,t(this).prop("checked",e.settings.transcriptScroll)})),this.$player.on("click","[data-cfw-player-script-describe]",(function(i){t.CFW_isDisabled(i.target)||(e.settings.transcriptDescribe=!e.settings.transcriptDescribe,t(this).prop("checked",e.settings.transcriptDescribe),e.scriptLoad())}))),i.CFW_Dropdown({target:"#"+s})}else i.removeClass("active"),this._pressedState(i,!1),i.on("click",(function(t){t.preventDefault(),i.hasClass("active")?e.scriptSet(-1):e.scriptSet(0),e._focusControl(this)}));-1!==this.settings.transcript&&this.scriptSet(this.settings.transcript)}},scriptSet:function(t){if(t=parseInt(t,10),!(this.trackValid.length<=0)&&(-1!==this.trackValid.indexOf(t)||-1===t)&&t!==this.scriptCurrent&&(-1!==t||null===this.$scriptElm||this.$media.CFW_trigger("beforeTranscriptHide.cfw.player"))&&this.$media.CFW_trigger("beforeTranscriptShow.cfw.player")){var e=this.$player.find('[data-cfw-player="transcript"]');if(null!==this.$scriptElm&&(this.$scriptElm.remove(),this.$scriptElm=null),this.$element.removeClass("player-scriptshow"),e.length)if(1!==this.trackValid.length||this.settings.transcriptOption){var i=e.parent();e.removeClass("active"),i.removeClass("active"),i.find("[data-cfw-player-script]").removeClass("active").removeAttr("aria-pressed")}else e.removeClass("active"),this._pressedState(e,!1);-1!==this.scriptCurrent&&this._cuechangeDisable(this.scriptCurrent,"transcript"),this.scriptCurrent=t,-1===t?(this.scriptCues=null,this.descCues=null,this.$media.CFW_trigger("afterTranscriptHide.cfw.player")):this.scriptLoad()}},scriptLoad:function(e){var i=this;void 0===e&&(e=!1),this.$media.off("loadeddata.cfw.player.script");var a=this.media.textTracks,s=a.length;s<=0&&(this.scriptCues=null,this.descCurrent=-1,this.descCues=null);for(var r=-1===this.trackCurrent?null:a[this.trackCurrent].mode,n=0;n<s;n++)a[n].mode="hidden";null!==r&&(a[this.trackCurrent].mode=r);var c=!1;if(this.descCurrent=-1,this.descCues=null,-1!==this.scriptCurrent)for(var l=a[this.scriptCurrent].language,o=0;o<s;o++)l===a[o].language&&"descriptions"===a[o].kind&&(i.settings.transcriptDescribe&&(i.descCurrent=o),c=!0);var p=this.$player.find("[data-cfw-player-script-describe]");c?t.CFW_controlEnable(p):t.CFW_controlDisable(p);for(var d=!1,u=0;u<s;u++)"descriptions"===a[u].kind&&(d=!0);var h=this.$player.find('[data-cfw-player="textdescription"]');d?t.CFW_controlEnable(h):t.CFW_controlDisable(h),setTimeout((function(){!function(t){var e=i.media.textTracks,a=-1===i.scriptCurrent?null:e[i.scriptCurrent].cues,s=-1===i.descCurrent?null:e[i.descCurrent].cues,r=-1===i.textDescribeCurrent?null:e[i.textDescribeCurrent].cues;if(a&&a.length<=0&&!t)return i.$media.one("loadeddata.cfw.player.script",(function(){i.scriptLoad(!0)})),void i.$media.trigger("load");i.scriptCues=a,i.descCues=s,i.textDescribeCues=r,i.scriptProcess()}(e)}),100)},scriptProcess:function(){var e=this;if(null!==this.scriptCues||null!==this.descCues){var i=function(e,i){var a=t('<span class="player-transcript-seekpoint player-transcript-caption"></span>'),s=i.getCueAsHTML();a.append(s),a.attr({"data-start":i.startTime.toString(),"data-end":i.endTime.toString()}),e.append(a),e.append("\n")},a=function(e,i){var a=t('<div class="player-description"></div>');a.append('<span class="sr-only">Description: </span>');var s=t('<span class="player-description-seekpoint player-description-caption"></span>'),r=i.getCueAsHTML();s.append(r),s.attr({"data-start":i.startTime.toString(),"data-end":i.endTime.toString()}),a.append(s),e.append(a),e.append("\n")},s=this.$player.find('[data-cfw-player="transcript"]');if(this.$element.addClass("player-scriptshow"),1!==this.trackValid.length||this.settings.transcriptOption){if(s.length){var r=s.parent();s.addClass("active"),r.addClass("active"),r.find('[data-cfw-player-script="'+this.scriptCurrent+'"]').addClass("active").attr("aria-pressed","true")}}else s.addClass("active"),this._pressedState(s,!0);this.$element.find(".player-transcript").remove();var n=t('<div class="player-transcript"></div>');this.$element.append(n),this.$scriptElm=this.$element.find(".player-transcript");for(var c=this.scriptCues||[],l=this.descCues||[],o=0,p=0,d=null;o<c.length||p<l.length;)null!==(d=p<l.length&&o<c.length?Math.min(l[p].startTime,c[o].startTime):null)?void 0!==l[p]&&l[p].startTime===d?(a(this.$scriptElm,l[p]),p+=1):(i(this.$scriptElm,c[o]),o+=1):p<l.length?(a(this.$scriptElm,l[p]),p+=1):o<c.length&&(i(this.$scriptElm,c[o]),o+=1);this._cuechangeEnable(this.scriptCurrent,"transcript",this.scriptHighlight),t(this.seekPoint,this.$scriptElm).off("click.cfw.player.scriptseek").on("click.cfw.player.scriptseek",(function(){var i=parseFloat(t(this).attr("data-start"));e.scriptSeek(i)})),this.$media.CFW_trigger("afterTranscriptShow.cfw.player")}},scriptHighlight:function(e){if(t(".player-transcript-active",this.$scriptElm).removeClass("player-transcript-active"),!(e.length<=0)){var i=e[0].startTime,a=t('.player-transcript-caption[data-start="'+i+'"]',this.$scriptElm);if(a.addClass("player-transcript-active"),this.settings.transcriptScroll){var s=this.$scriptElm.scrollTop(),r=this.$scriptElm.innerHeight()/2,n=a.position().top,c=a.height()/2,l=Math.floor(s+n-r+c);l!==Math.floor(s)&&this.$scriptElm.scrollTop(l)}}},scriptSeek:function(t){var e=this;t+=.01,this.media.readyState<2?(this.$media.one("canplay",(function(){e.seekTo(t)})),this.$media.trigger("load")):this.seekTo(t)},textDescriptionInit:function(){var e=this,i=this.$player.find('[data-cfw-player="textdescription"]');if(!(i.length<=0))if(this.trackDescription.length<=0)t.CFW_controlDisable(i);else{var a=t('<ul class="player-text-describe-menu dropdown-menu"></ul>');i.wrap('<span class="player-text-describe-wrapper"></span>'),i.parent().append(a);var s=a.CFW_getID("cfw-player"),r=t('<li class="player-text-describe-off"><button type="button" class="dropdown-item" data-cfw-player-text-describe="-1">Off</button></li>');a.append(r);for(var n=this.media.textTracks,c=0;c<this.trackDescription.length;c++){var l=this.trackDescription[c];r=t('<li><button type="button" class="dropdown-item" data-cfw-player-text-describe="'+l+'">'+n[l].label+"</a></li>"),a.append(r)}if(this.settings.transcriptOption){r=t('<li class="dropdown-divider"></li>'),a.append(r);var o=this.settings.textDescribeAnnounce?"checked":"",p="textDescribeAnnounce-"+s;r=t('<li class="dropdown-text"><div class="form-check"><input type="checkbox" data-cfw-player-text-describe-announce class="form-check-input" '+o+' id="'+p+'"> <label class="form-check-label" for="'+p+'">Announce with Screen Reader</label></div></li>'),a.append(r);var d=this.settings.textDescribeVisible?"checked":"",u="textDescribeVisible-"+s;r=t('<li class="dropdown-text"><div class="form-check"><input type="checkbox" data-cfw-player-text-describe-visible class="form-check-input" '+d+' id="'+u+'"> <label class="form-check-label" for="'+u+'">Visible Description</label></div></li>'),a.append(r)}this.$player.on("click","[data-cfw-player-text-describe]",(function(i){i.preventDefault();var a=t(this).attr("data-cfw-player-text-describe");e.textDescriptionSet(a)})),this.settings.transcriptOption&&(this.$player.on("click","[data-cfw-player-text-describe-announce]",(function(){e.settings.textDescribeAnnounce=!e.settings.textDescribeAnnounce,t(this).prop("checked",e.settings.textDescribeAnnounce),e.textDescriptionSet(e.textDescribeCurrent)})),this.$player.on("click","[data-cfw-player-text-describe-visible]",(function(i){t.CFW_isDisabled(i.target)||(e.settings.textDescribeVisible=!e.settings.textDescribeVisible,t(this).prop("checked",e.settings.textDescribeVisible),e.textDescriptionSet(e.textDescribeCurrent))}))),i.CFW_Dropdown({target:"#"+s}),this.textDescriptionSet(this.settings.textDescribe)}},textDescriptionSet:function(e){if(e=parseInt(e,10),!(this.trackDescription.length<=0||-1===this.trackDescription.indexOf(e)&&-1!==e)){if(-1===e&&null!==this.$textDescribeElm){if(!this.$media.CFW_trigger("beforeTextDescriptionHide.cfw.player"))return}else if(!this.$media.CFW_trigger("beforeTextDescriptionShow.cfw.player"))return;null!==this.$textDescribeElm&&(this.$textDescribeElm.remove(),this.$textDescribeElm=null),this.$element.removeClass("player-textdescshow"),this.$element.find(".player-textdesc-announce").remove(),this.$element.find(".player-textdesc-visible").remove();var i=this.$player.find('[data-cfw-player="textdescription"]');if(i.length){var a=i.parent();i.removeClass("active"),a.removeClass("active"),a.find("[data-cfw-player-text-describe]").removeClass("active").removeAttr("aria-pressed"),-1!==e&&(i.addClass("active"),a.addClass("active"),a.find('[data-cfw-player-text-describe="'+e+'"]').addClass("active").attr("aria-pressed","true"))}if(-1!==this.textDescribeCurrent&&this._cuechangeDisable(this.textDescribeCurrent,"textdescribe"),this.textDescribeCurrent=e,-1===e?(this.textDescribeCues=null,this.$media.CFW_trigger("afterTextDescriptionHide.cfw.player")):this.scriptLoad(),-1!==e){var s=t('<div class="player-textdesc"></div>'),r=this.media.textTracks[e].language;r.length&&s.attr("lang",r),this.settings.textDescribeAnnounce&&s.attr({"aria-live":"assertive","aria-atomic":"true"}),this.settings.textDescribeVisible||s.addClass("sr-only"),this.$element.append(s),this.$textDescribeElm=this.$element.find(".player-textdesc"),this._cuechangeEnable(this.textDescribeCurrent,"textdescribe",this.textDescribeUpdate),this.$media.CFW_trigger("afterTextDescriptionShow.cfw.player")}}},textDescribeUpdate:function(e){if(null===e||e.length<=0)this.$textDescribeElm.empty();else{var i=t(document.createElement("div"));i.append(e[0].getCueAsHTML());var a=i.html().replace("\n","<br>");this.$textDescribeElm.append(a)}},activityInit:function(){var t=this;setInterval((function(){t.activity&&!t.over&&(t.activity=!1,clearTimeout(t.activityTimer),t.activityStatus(!0),t.activityTimer=setTimeout((function(){t.activity||t.activityStatus(!1)}),1e3))}),250)},activityStatus:function(t){t!==this.userActive&&(this.userActive=t,t?(this.activity=!0,this.$element.removeClass("player-inactive")):(this.activity=!1,this.$element.one("mousemove",(function(t){t.stopPropagation(),t.preventDefault()})),this.$element.addClass("player-inactive")))},captionDisplayUpdate:function(e){if(null!==this.$captionWrapper)if(-1===this.trackCurrent||null===e||e.length<=0)this.$captionWrapper.attr("aria-hidden","true").css("display","none").empty();else{var i=t(document.createElement("div"));i.append(e[0].getCueAsHTML());var a=i.html().replace("\n","<br>");this.$captionWrapper.removeAttr("aria-hidden").css("display","").append(a)}},_actionsKeydown:function(e){if(/(32|33|34|35|36|37|38|39|40|70|77)/.test(e.which)&&32!==e.which&&"button"!==e.target.tagName&&"button"!==t(e.target).attr("role"))switch(e.stopPropagation(),e.preventDefault(),e.which){case 32:this.media.paused?this.media.play():this.media.pause(),this._focusHelper();break;case 38:this.volumeIncrement(5);break;case 40:this.volumeIncrement(-5);break;case 36:this.seekTo(0);break;case 35:this.seekTo(this.media.duration);break;case 37:this.seekIncrement(-5);break;case 39:this.seekIncrement(5);break;case 33:this.seekIncrement(this.status.duration/5);break;case 34:this.seekIncrement(this.status.duration/-5);break;case 70:this.fullscreen();break;case 77:this.mute()}},_pressedState:function(t,e){if(!(t.length<=0)){var i=t.get(0).nodeName.toLowerCase(),a=t.attr("role");"button"!==i&&"button"!==a||t.attr("aria-pressed",e)}},_focusControl:function(e){var i=t(e);i.length<=0||setTimeout((function(){i.is("a, button")?i.trigger("focus"):i.find("a:visible, button:visible").eq(0).trigger("focus")}),150)},_focusHelper:function(){var e=this,i=t(document.activeElement);setTimeout((function(){i.is(":visible")||e.$focus.trigger("focus")}),10)},_cuechangeEnable:function(e,i,a){var s,r=this;void 0!==this.media.textTracks[e].oncuechange?t(this.media.textTracks[e]).on("cuechange.cfw.player."+i,(function(){a.call(r,this.activeCues)})):this.$media.on("timeupdate.cfw.player."+i,(function(){var t=r.media.textTracks[e].activeCues;a.call(r,t)})),void 0!==this.media.textTracks[e].oncuechange?(s=t.Event("cuechange"),t(this.media.textTracks[e]).trigger(s)):(s=t.Event("timeupdate"),this.$media.trigger(s))},_cuechangeDisable:function(e,i){t(this.media.textTracks[e]).off("cuechange.cfw.player."+i),this.$media.off("timeupdate.cfw.player."+i)},dispose:function(){clearTimeout(this.activityTimer),this.$scriptElm&&(t(this.seekPoint,this.$scriptElm).off(".cfw.player.seekpoint"),this.$scriptElm.remove()),this.$sliderSeek&&this.$sliderSeek.off(),this.$volSeek&&this.$volSeek.off(),t.hasData(this.$player.find('[data-cfw-player="caption"]'))&&this.$player.find('[data-cfw-player="caption"]').CFW_Dropdown("dispose"),t.hasData(this.$player.find('[data-cfw-player="transcript"]'))&&this.$player.find('[data-cfw-player="transcript"]').CFW_Dropdown("dispose"),this.$player.off(),this.$media.off(),this.$element.off().removeData("cfw.player"),this.$element=null,this.type=null,this.$media=null,this.media=null,this.$player=null,this.$sources=null,this.$focus=null,this.$sliderSeek=null,this.$volSeek=null,this.activity=null,this.over=null,this.userActive=null,this.activityTimer=null,this.mouseActivity=null,this.played=null,this.status=null,this.support=null,this.trackValid=null,this.trackCurrent=null,this.$captionWrapper=null,this.$scriptElm=null,this.scriptCurrent=null,this.scriptCues=null,this.descCues=null,this.trackDescription=null,this.$textDescribeElm=null,this.textDescribeCurrent=null,this.textDescribeCues=null,this.settings=null}},t.fn.CFW_Player=function(e){var a=[].splice.call(arguments,1);return this.each((function(){var s=t(this),r=s.data("cfw.player"),n="object"==typeof e&&e;r||s.data("cfw.player",r=new i(this,n)),"string"==typeof e&&r[e].apply(r,a)}))},t.fn.CFW_Player.Constructor=i,t(window).ready((function(){t('[data-cfw="player"]').CFW_Player()}))}(jQuery);